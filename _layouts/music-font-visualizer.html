---
layout: base
image: /images/music.png
seo: { "type": "MusicGroup" }
dark: true
---

<header>
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 15" style="margin-left:-5%">
    <style>
      text {
        line-height: 1;
        font-size: 12px;
        font-weight: 100;
        font-family: {{ site.font_family }};
      }
    </style>
    <title>{{ page.title }}</title>
    <rect x="0" y="0" width="100%" height="100%" fill="black" stroke="0"></rect>
    {% assign chars = page.title | characters %}
    <text x="0" y="12" fill="white" stroke="white" stroke-width="0"><tspan>&nbsp;</tspan>{% for x in chars %}<tspan {% if forloop.first %}x="5%"{% endif %}>{{ x }}</tspan>{% endfor %}</text>
  </svg>
  <div align="center">
    <audio preload controls>
      <source src="/music/Kofi Gumbs-{{ page.title }}.mp3" type="audio/mpeg">
    </audio>
  </div>
</header>

{% include footer.html %}

<script>
  const AudioContext = window.AudioContext || window.webkitAudioContext;
  const audioContext = new AudioContext();

  const link = document.querySelector("a");
  const svg = document.querySelector("text");
  const audio = document.querySelector("audio");
  const source = audioContext.createMediaElementSource(audio);
  const analyser = audioContext.createAnalyser();

  source.connect(analyser)
  source.connect(audioContext.destination);
  audio.addEventListener("play", () => audioContext.resume());

  analyser.fftSize = 256;
  const letters = Array.from(svg.children).slice(1);
  const buffer = new Uint8Array(analyser.frequencyBinCount);
  const step = analyser.frequencyBinCount / letters.length / 2;
  (function loop() {
    requestAnimationFrame(loop);
    analyser.getByteFrequencyData(buffer);
    for(let i = 0; i < letters.length; i++) {
      const data = buffer.slice(Math.floor(i * step), Math.ceil((i + 1) * step));
      let sum = 0;
      for (const x of data) sum += x;
      letters[i].style.strokeWidth = sum / data.length / 96;
    }
  })();
</script>
